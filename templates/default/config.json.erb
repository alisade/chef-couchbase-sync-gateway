{
    "adminInterface": "<%= node['sync_gateway']['adminInterface'] %>"
    , "adminUI": "<% node['sync_gateway']['adminUI'] %>"
    , "compressResponses": <%= node['sync_gateway']['compressResponses'] %>
    <% unless node['sync_gateway']['configServer'].nil? %>
        , "configServer": "<%= node['sync_gateway']['configServer'] %>
    <% end %>
    <% unless node['sync_gateway']['CORS'].nil? %>
        , "CORS": "<%= node['sync_gateway']['CORS'] %>
    <% end %>
    <% unless node['sync_gateway']['CouchbaseKeepaliveInterval'].nil? %>
        , "CouchbaseKeepaliveInterval": <%= node['sync_gateway']['CouchbaseKeepaliveInterval'] %>
    <% end %>
    <% unless node['sync_gateway']['databases'].nil? %>
        , "databases": {
            <% node['sync_gateway']['databases'].each_with_index do |config, i| %>
            "<%= config['name'] %>": {
                "bucket": "<%= config['bucket'] %>"
                , "server": "<%= config['server'] %>"
                , "sync": `<%= config['sync'].gsub(/\r\n?/, '\n') %>`
                <% unless config['username'].nil? %>
                    , "username": "<%= config['username'] %>"
                <% end %>
                <% unless config['password'].nil? %>
                    , "password": "<%= config['password'] %>"
                <% end %>
                <% unless config['shadow'].nil? %>
                    , "shadow": <%= config['shadow'].to_json %>
                <% end %>
                <% unless config['rev_cache_size'].nil? %>
                    , "revCacheSize": "<%=config['rev_cache_size'] %>"
                <% end %>
            }
            <%= ',' if i < (node['sync_gateway']['databases'].size - 1) %>
            <% end %>
        }
    <% end %>
    <% unless node['sync_gateway']['facebook'].nil? %>
        , "facebook": <%= node['sync_gateway']['facebook'].to_json %>
    <% end %>
    , "interface": "<%= node['sync_gateway']['interface'] %>"
    , "log": <%= node['sync_gateway']['log'].to_json %>
    , "logFilePath": "<%= node['sync_gateway']['logFilePath'] %>"
    <% unless node['sync_gateway']['maxCouchbaseOverflow'].nil? %>
        , "maxCouchbaseOverflow": <%= node['sync_gateway']['maxCouchbaseOverflow'] %>
    <% end %>
    , "maxFileDestriptors": <%= node['sync_gateway']['maxFileDescriptors'] %>
    <% unless node['sync_gateway']['maxHeartbeat'].nil? %>
        , "maxHeartbeat": <%= node['sync_gateway']['maxHeartbeat'] %>
    <% end %>
    <% unless node['sync_gateway']['maxIncomingConnections'].nil? %>
        , "maxIncomingConnections": <%= node['sync_gateway']['maxIncomingConnections'] %>
    <% end %>
    <% unless node['sync_gateway']['persona'].nil? %>
        , "persona": <%= node['sync_gateway']['persona'].to_json %>
    <% end %>
    , "pretty": <%= node['sync_gateway']['pretty'] %>
    <% unless node['sync_gateway']['profileInterface'].nil? %>
        , "profileInterface": "<%= node['sync_gateway']['profileInterface'] %>"
    <% end %>
    <% unless node['sync_gateway']['serverReadTimeout'].nil? %>
        , "serverReadTimeout": <%= node['sync_gateway']['serverReadTimeout'] %>
    <% end %>
    <% unless node['sync_gateway']['serverWriteTimeout'].nil? %>
        , "serverWriteTimeout": <%= node['sync_gateway']['serverWriteTimeout'] %>
    <% end %>
    , "slowServerCallWarningThreshold": <%= node['sync_gateway']['slowServerCallWarningThreshold'] %>
    <% unless node['sync_gateway']['SSLCert'].nil? %>
        , "SSLCert": "<%= node['sync_gateway']['SSLCert'] %>"
    <% end %>
    <% unless node['sync_gateway']['SSLKey'].nil? %>
        , "SSLKey": "<%= node['sync_gateway']['SSLKey'] %>"
    <% end %>
}

